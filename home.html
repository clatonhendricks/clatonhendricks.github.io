<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>iKan Word Addin</title>

    <script src="Scripts/jquery-3.6.0.js" type="text/javascript"></script>
    <script src="Scripts/MessageBanner.js" type="text/javascript"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>

    <script src="Scripts/Home.js" type="text/javascript"></script>
    <link href="Content/Home.css" rel="stylesheet" type="text/css" />
    <link href="Content/Button.css" rel="stylesheet" type="text/css" />
    <link href="Content/MessageBanner.css" rel="stylesheet" type="text/css" />


    <!-- For Office UI Fabric Core, go to https://aka.ms/office-ui-fabric to learn more. -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/9.6.0/css/fabric.min.css">

    <!-- To enable the offline use of Office UI Fabric Core, use: -->
    <!-- link rel="stylesheet" href="Content/fabric.min.css" -->
</head>

<!-- Office UI Fabric JS and it's components are no longer actively supported. Please see https://aka.ms/PnP-OfficeFabricReact for recommended Patterns and Practices -->
<!-- <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.components.min.css"> -->

<body class="ms-Fabric" dir="ltr">
    <div id="content-header">
        <div class="text-center">
            <h1 style="text-align: center;">iKan</h1>
            <h4 style="text-align: center;">Your AI assistant</h4>
        </div>

    </div>

    <div id="content-main">
        <div class="padding">
            <p>Choose options below to use OpenAI to assist.</p>
        </div>
        <div>
            <button class="accordion">Help me rewrite</button>
            <div class="panel">
                <br />
                <label for="fname">Select text from the document</label>
                <br />
                <br />
                <button class="buttonstyle" type="button" id="btnrewrite">Rephase selected text</button>
                <br />
                <label class="padding" id="message"></label>
                <button class="buttonstyle" type="button" style="visibility:hidden;" id="btnInsert">Insert to document</button>
                <div class="loader" id="circleloader-1"></div>

            </div>

            <br />
            <button class="accordion">Help me with ideas</button>
            <div class="panel">
                <br />
                <textarea id="txtIdeas" placeholder="Generate a project template" rows="4" cols="40"></textarea>
                <br />
                <br />
                <button class="buttonstyle" type="button" id="btnIdeas">Generate Ideas</button>
                <br />
                <br />
                <div class="loader" id="circleloader-2"></div>

            </div>

        </div>

    </div>

    <div id="alert-message">
        <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
        <label style="font-weight:bold" id="errTitle">Error</label>
        <br />
        <label id="errDesc"></label>
    </div>

    <div class="settings-pos">
        <span class="caret">Settings</span>
        <div class="nested">
            <label>Following settings will be saved as cookies</label>
            <div class="grid-container">
                <label>OpenAPI key:</label>
                <textarea id="txtKey" rows="1" cols="30"></textarea>
                <label>Max tokens:</label>
                <textarea id="txtmaxtokens" rows="1" cols="4">200</textarea>
                <button type="button" id="btnSaveSettings">Save</button>

            </div>
            <a href="https://www.OpenAI.com/">  Get your key from OpenAI</a>
            <br/>
            <a href="https://github.com/clatonhendricks/OpenAI/tree/main/iKan">  iKan is an opensource project</a>
        </div>
    </div>

    <br />
    <div id="supportedVersion" />

    <script>
        //script for the main options accordion
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var panel = this.nextElementSibling;
                if (panel.style.display === "block") {
                    panel.style.display = "none";
                } else {
                    panel.style.display = "block";
                }
            });
        }

        // script for the settings caret
        var toggler = document.getElementsByClassName("caret");
        var i;

        for (i = 0; i < toggler.length; i++) {
            toggler[i].addEventListener("click", function () {
                this.parentElement.querySelector(".nested").classList.toggle("caret-active");
                this.classList.toggle("caret-down");
            });
        }

    </script>

</body>
</html>
